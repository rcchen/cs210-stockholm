<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>bootstrap-tagsinput.js - RDoc Documentation</title>

<link href="./fonts.css" rel="stylesheet">
<link href="./rdoc.css" rel="stylesheet">

<script type="text/javascript">
  var rdoc_rel_prefix = "./";
</script>

<script src="./js/jquery.js"></script>
<script src="./js/navigation.js"></script>
<script src="./js/search_index.js"></script>
<script src="./js/search.js"></script>
<script src="./js/searcher.js"></script>
<script src="./js/darkfish.js"></script>


<body id="top" role="document" class="file">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="./index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="./table_of_contents.html#pages">Pages</a>
    <a href="./table_of_contents.html#classes">Classes</a>
    <a href="./table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  

  <div id="project-metadata">
    <div id="fileindex-section" class="nav-section">
  <h3>Pages</h3>

  <ul class="link-list">
  
    <li><a href="./api_js_coffee.html">api.js.coffee</a>
  
    <li><a href="./application_js.html">application.js</a>
  
    <li><a href="./backbone/cs210_stockholm_js_coffee.html">cs210_stockholm.js.coffee</a>
  
    <li><a href="./bootstrap-tagsinput_js.html">bootstrap-tagsinput.js</a>
  
    <li><a href="./collections_js_coffee.html">collections.js.coffee</a>
  
    <li><a href="./create_js_coffee.html">create.js.coffee</a>
  
    <li><a href="./d3_min_js.html">d3.min.js</a>
  
    <li><a href="./dashboard_js_coffee.html">dashboard.js.coffee</a>
  
    <li><a href="./dataset_js_coffee.html">dataset.js.coffee</a>
  
    <li><a href="./draggabilly_pkgd_js.html">draggabilly.pkgd.js</a>
  
    <li><a href="./entries_js_coffee.html">entries.js.coffee</a>
  
    <li><a href="./gmaps_js.html">gmaps.js</a>
  
    <li><a href="./graph_js_coffee.html">graph.js.coffee</a>
  
    <li><a href="./jquery_form_min_js.html">jquery.form.min.js</a>
  
    <li><a href="./nv_d3_js.html">nv.d3.js</a>
  
    <li><a href="./packery_pkgd_min_js.html">packery.pkgd.min.js</a>
  
    <li><a href="./parser_js_coffee.html">parser.js.coffee</a>
  
    <li><a href="./properties_js_coffee.html">properties.js.coffee</a>
  
    <li><a href="./spin_min_js.html">spin.min.js</a>
  
    <li><a href="./tag-it_min_js.html">tag-it.min.js</a>
  
    <li><a href="./typeahead_js.html">typeahead.js</a>
  
    <li><a href="./users_js_coffee.html">users.js.coffee</a>
  
    <li><a href="./visualization_js_coffee.html">visualization.js.coffee</a>
  
    <li><a href="./welcome_js_coffee.html">welcome.js.coffee</a>
  
    <li><a href="./worksheet_js_coffee.html">worksheet.js.coffee</a>
  
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-label="Page bootstrap-tagsinput.js">

<p>(function ($) {</p>

<pre class="ruby"><span class="ruby-string">&quot;use strict&quot;</span>;

<span class="ruby-identifier">var</span> <span class="ruby-identifier">defaultOptions</span> = {
  <span class="ruby-identifier">tagClass</span><span class="ruby-operator">:</span> <span class="ruby-identifier">function</span>(<span class="ruby-identifier">item</span>) {
    <span class="ruby-keyword">return</span> <span class="ruby-string">&#39;label label-info&#39;</span>;
  },
  <span class="ruby-identifier">itemValue</span><span class="ruby-operator">:</span> <span class="ruby-identifier">function</span>(<span class="ruby-identifier">item</span>) {
    <span class="ruby-keyword">return</span> <span class="ruby-identifier">item</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">item</span>.<span class="ruby-identifier">toString</span>() <span class="ruby-operator">:</span> <span class="ruby-identifier">item</span>;
  },
  <span class="ruby-identifier">itemText</span><span class="ruby-operator">:</span> <span class="ruby-identifier">function</span>(<span class="ruby-identifier">item</span>) {
    <span class="ruby-keyword">return</span> <span class="ruby-identifier">this</span>.<span class="ruby-identifier">itemValue</span>(<span class="ruby-identifier">item</span>);
  },
  <span class="ruby-identifier">freeInput</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>,
  <span class="ruby-identifier">maxTags</span><span class="ruby-operator">:</span> <span class="ruby-identifier">undefined</span>,
  <span class="ruby-identifier">confirmKeys</span><span class="ruby-operator">:</span> [<span class="ruby-value">13</span>],
  <span class="ruby-identifier">onTagExists</span><span class="ruby-operator">:</span> <span class="ruby-identifier">function</span>(<span class="ruby-identifier">item</span>, <span class="ruby-identifier">$tag</span>) {
    <span class="ruby-identifier">$tag</span>.<span class="ruby-identifier">hide</span>().<span class="ruby-identifier">fadeIn</span>();
  }
};

   <span class="ruby-constant">Constructor</span> <span class="ruby-identifier">function</span>

<span class="ruby-identifier">function</span> <span class="ruby-constant">TagsInput</span>(<span class="ruby-identifier">element</span>, <span class="ruby-identifier">options</span>) {
  <span class="ruby-identifier">this</span>.<span class="ruby-identifier">itemsArray</span> = [];

  <span class="ruby-identifier">this</span>.<span class="ruby-identifier">$element</span> = $(<span class="ruby-identifier">element</span>);
  <span class="ruby-identifier">this</span>.<span class="ruby-identifier">$element</span>.<span class="ruby-identifier">hide</span>();

  <span class="ruby-identifier">this</span>.<span class="ruby-identifier">isSelect</span> = (<span class="ruby-identifier">element</span>.<span class="ruby-identifier">tagName</span> <span class="ruby-operator">===</span> <span class="ruby-string">&#39;SELECT&#39;</span>);
  <span class="ruby-identifier">this</span>.<span class="ruby-identifier">multiple</span> = (<span class="ruby-identifier">this</span>.<span class="ruby-identifier">isSelect</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">element</span>.<span class="ruby-identifier">hasAttribute</span>(<span class="ruby-string">&#39;multiple&#39;</span>));
  <span class="ruby-identifier">this</span>.<span class="ruby-identifier">objectItems</span> = <span class="ruby-identifier">options</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">options</span>.<span class="ruby-identifier">itemValue</span>;
  <span class="ruby-identifier">this</span>.<span class="ruby-identifier">placeholderText</span> = <span class="ruby-identifier">element</span>.<span class="ruby-identifier">hasAttribute</span>(<span class="ruby-string">&#39;placeholder&#39;</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">this</span>.<span class="ruby-identifier">$element</span>.<span class="ruby-identifier">attr</span>(<span class="ruby-string">&#39;placeholder&#39;</span>) <span class="ruby-operator">:</span> <span class="ruby-string">&#39;&#39;</span>;
  <span class="ruby-identifier">this</span>.<span class="ruby-identifier">inputSize</span> = <span class="ruby-constant">Math</span>.<span class="ruby-identifier">max</span>(<span class="ruby-value">1</span>, <span class="ruby-identifier">this</span>.<span class="ruby-identifier">placeholderText</span>.<span class="ruby-identifier">length</span>);

  <span class="ruby-identifier">this</span>.<span class="ruby-identifier">$container</span> = $(<span class="ruby-string">&#39;&lt;div class=&quot;bootstrap-tagsinput&quot;&gt;&lt;/div&gt;&#39;</span>);
  <span class="ruby-identifier">this</span>.<span class="ruby-identifier">$input</span> = $(<span class="ruby-string">&#39;&lt;input size=&quot;&#39;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">this</span>.<span class="ruby-identifier">inputSize</span> <span class="ruby-operator">+</span> <span class="ruby-string">&#39;&quot; type=&quot;text&quot; placeholder=&quot;&#39;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">this</span>.<span class="ruby-identifier">placeholderText</span> <span class="ruby-operator">+</span> <span class="ruby-string">&#39;&quot;/&gt;&#39;</span>).<span class="ruby-identifier">appendTo</span>(<span class="ruby-identifier">this</span>.<span class="ruby-identifier">$container</span>);

  <span class="ruby-identifier">this</span>.<span class="ruby-identifier">$element</span>.<span class="ruby-identifier">after</span>(<span class="ruby-identifier">this</span>.<span class="ruby-identifier">$container</span>);

  <span class="ruby-identifier">this</span>.<span class="ruby-identifier">build</span>(<span class="ruby-identifier">options</span>);
}

<span class="ruby-constant">TagsInput</span>.<span class="ruby-identifier">prototype</span> = {
  <span class="ruby-identifier">constructor</span><span class="ruby-operator">:</span> <span class="ruby-constant">TagsInput</span>,

  <span class="ruby-regexp">/**
     Adds the given item as a new tag. Pass true to dontPushVal to prevent
     updating the elements val()
    /</span>
  <span class="ruby-identifier">add</span><span class="ruby-operator">:</span> <span class="ruby-identifier">function</span>(<span class="ruby-identifier">item</span>, <span class="ruby-identifier">dontPushVal</span>) {
    <span class="ruby-identifier">var</span> <span class="ruby-keyword">self</span> = <span class="ruby-identifier">this</span>;

    <span class="ruby-keyword">if</span> (<span class="ruby-keyword">self</span>.<span class="ruby-identifier">options</span>.<span class="ruby-identifier">maxTags</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">itemsArray</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">options</span>.<span class="ruby-identifier">maxTags</span>)
      <span class="ruby-keyword">return</span>;

    <span class="ruby-regexp">//</span> <span class="ruby-constant">Ignore</span> <span class="ruby-identifier">falsey</span> <span class="ruby-identifier">values</span>, <span class="ruby-identifier">except</span> <span class="ruby-keyword">false</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">item</span> <span class="ruby-operator">!=</span>= <span class="ruby-keyword">false</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">item</span>)
      <span class="ruby-keyword">return</span>;

    <span class="ruby-regexp">//</span> <span class="ruby-constant">Throw</span> <span class="ruby-identifier">an</span> <span class="ruby-identifier">error</span> <span class="ruby-keyword">when</span> <span class="ruby-identifier">trying</span> <span class="ruby-identifier">to</span> <span class="ruby-identifier">add</span> <span class="ruby-identifier">an</span> <span class="ruby-identifier">object</span> <span class="ruby-keyword">while</span> <span class="ruby-identifier">the</span> <span class="ruby-identifier">itemValue</span> <span class="ruby-identifier">option</span> <span class="ruby-identifier">was</span> <span class="ruby-keyword">not</span> <span class="ruby-identifier">set</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">typeof</span> <span class="ruby-identifier">item</span> <span class="ruby-operator">===</span> <span class="ruby-string">&quot;object&quot;</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-keyword">self</span>.<span class="ruby-identifier">objectItems</span>)
      <span class="ruby-identifier">throw</span>(<span class="ruby-string">&quot;Can&#39;t add objects when itemValue option is not set&quot;</span>);

    <span class="ruby-regexp">//</span> <span class="ruby-constant">Ignore</span> <span class="ruby-identifier">strings</span> <span class="ruby-identifier">only</span> <span class="ruby-identifier">containg</span> <span class="ruby-identifier">whitespace</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">item</span>.<span class="ruby-identifier">toString</span>().<span class="ruby-identifier">match</span>(<span class="ruby-regexp">/^\s*$/</span>))
      <span class="ruby-keyword">return</span>;

    <span class="ruby-regexp">//</span> <span class="ruby-constant">If</span> <span class="ruby-constant">SELECT</span> <span class="ruby-identifier">but</span> <span class="ruby-keyword">not</span> <span class="ruby-identifier">multiple</span>, <span class="ruby-identifier">remove</span> <span class="ruby-identifier">current</span> <span class="ruby-identifier">tag</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-keyword">self</span>.<span class="ruby-identifier">isSelect</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-keyword">self</span>.<span class="ruby-identifier">multiple</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">itemsArray</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>)
      <span class="ruby-keyword">self</span>.<span class="ruby-identifier">remove</span>(<span class="ruby-keyword">self</span>.<span class="ruby-identifier">itemsArray</span>[<span class="ruby-value">0</span>]);

    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">typeof</span> <span class="ruby-identifier">item</span> <span class="ruby-operator">===</span> <span class="ruby-string">&quot;string&quot;</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">this</span>.<span class="ruby-identifier">$element</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">tagName</span> <span class="ruby-operator">===</span> <span class="ruby-string">&#39;INPUT&#39;</span>) {
      <span class="ruby-identifier">var</span> <span class="ruby-identifier">items</span> = <span class="ruby-identifier">item</span>.<span class="ruby-identifier">split</span>(<span class="ruby-string">&#39;,&#39;</span>);
      <span class="ruby-keyword">if</span> (<span class="ruby-identifier">items</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span>) {
        <span class="ruby-keyword">for</span> (<span class="ruby-identifier">var</span> <span class="ruby-identifier">i</span> = <span class="ruby-value">0</span>; <span class="ruby-identifier">i</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">items</span>.<span class="ruby-identifier">length</span>; <span class="ruby-identifier">i</span><span class="ruby-operator">+</span><span class="ruby-operator">+</span>) {
          <span class="ruby-identifier">this</span>.<span class="ruby-identifier">add</span>(<span class="ruby-identifier">items</span>[<span class="ruby-identifier">i</span>], <span class="ruby-keyword">true</span>);
        }

        <span class="ruby-keyword">if</span> (<span class="ruby-operator">!</span><span class="ruby-identifier">dontPushVal</span>)
          <span class="ruby-keyword">self</span>.<span class="ruby-identifier">pushVal</span>();
        <span class="ruby-keyword">return</span>;
      }
    }

    <span class="ruby-identifier">var</span> <span class="ruby-identifier">itemValue</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">options</span>.<span class="ruby-identifier">itemValue</span>(<span class="ruby-identifier">item</span>),
        <span class="ruby-identifier">itemText</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">options</span>.<span class="ruby-identifier">itemText</span>(<span class="ruby-identifier">item</span>),
        <span class="ruby-identifier">tagClass</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">options</span>.<span class="ruby-identifier">tagClass</span>(<span class="ruby-identifier">item</span>);

    <span class="ruby-regexp">//</span> <span class="ruby-constant">Ignore</span> <span class="ruby-identifier">items</span> <span class="ruby-identifier">allready</span> <span class="ruby-identifier">added</span>
    <span class="ruby-identifier">var</span> <span class="ruby-identifier">existing</span> = <span class="ruby-identifier">$.</span><span class="ruby-identifier">grep</span>(<span class="ruby-keyword">self</span>.<span class="ruby-identifier">itemsArray</span>, <span class="ruby-identifier">function</span>(<span class="ruby-identifier">item</span>) { <span class="ruby-keyword">return</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">options</span>.<span class="ruby-identifier">itemValue</span>(<span class="ruby-identifier">item</span>) <span class="ruby-operator">===</span> <span class="ruby-identifier">itemValue</span>; } )[<span class="ruby-value">0</span>];
    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">existing</span>) {
      <span class="ruby-regexp">//</span> <span class="ruby-constant">Invoke</span> <span class="ruby-identifier">onTagExists</span>
      <span class="ruby-keyword">if</span> (<span class="ruby-keyword">self</span>.<span class="ruby-identifier">options</span>.<span class="ruby-identifier">onTagExists</span>) {
        <span class="ruby-identifier">var</span> <span class="ruby-identifier">$existingTag</span> = $(<span class="ruby-string">&quot;.tag&quot;</span>, <span class="ruby-keyword">self</span>.<span class="ruby-identifier">$container</span>).<span class="ruby-identifier">filter</span>(<span class="ruby-identifier">function</span>() { <span class="ruby-keyword">return</span> $(<span class="ruby-identifier">this</span>).<span class="ruby-identifier">data</span>(<span class="ruby-string">&quot;item&quot;</span>) <span class="ruby-operator">===</span> <span class="ruby-identifier">existing</span>; });
        <span class="ruby-keyword">self</span>.<span class="ruby-identifier">options</span>.<span class="ruby-identifier">onTagExists</span>(<span class="ruby-identifier">item</span>, <span class="ruby-identifier">$existingTag</span>);
      }
      <span class="ruby-keyword">return</span>;
    }

    <span class="ruby-regexp">//</span> <span class="ruby-identifier">register</span> <span class="ruby-identifier">item</span> <span class="ruby-keyword">in</span> <span class="ruby-identifier">internal</span> <span class="ruby-identifier">array</span> <span class="ruby-keyword">and</span> <span class="ruby-identifier">map</span>
    <span class="ruby-keyword">self</span>.<span class="ruby-identifier">itemsArray</span>.<span class="ruby-identifier">push</span>(<span class="ruby-identifier">item</span>);

    <span class="ruby-regexp">//</span> <span class="ruby-identifier">add</span> <span class="ruby-identifier">a</span> <span class="ruby-identifier">tag</span> <span class="ruby-identifier">element</span>
    <span class="ruby-identifier">var</span> <span class="ruby-identifier">$tag</span> = $(<span class="ruby-string">&#39;&lt;span class=&quot;tag &#39;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">htmlEncode</span>(<span class="ruby-identifier">tagClass</span>) <span class="ruby-operator">+</span> <span class="ruby-string">&#39;&quot;&gt;&#39;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">htmlEncode</span>(<span class="ruby-identifier">itemText</span>) <span class="ruby-operator">+</span> <span class="ruby-string">&#39;&lt;span data-role=&quot;remove&quot;&gt;&lt;/span&gt;&lt;/span&gt;&#39;</span>);
    <span class="ruby-identifier">$tag</span>.<span class="ruby-identifier">data</span>(<span class="ruby-string">&#39;item&#39;</span>, <span class="ruby-identifier">item</span>);
    <span class="ruby-keyword">self</span>.<span class="ruby-identifier">findInputWrapper</span>().<span class="ruby-identifier">before</span>(<span class="ruby-identifier">$tag</span>);
    <span class="ruby-identifier">$tag</span>.<span class="ruby-identifier">after</span>(<span class="ruby-string">&#39; &#39;</span>);

    <span class="ruby-regexp">//</span> <span class="ruby-identifier">add</span> <span class="ruby-operator">&lt;</span><span class="ruby-identifier">option</span> <span class="ruby-regexp">/&gt; if item represents a value not present in one of the &lt;select /</span><span class="ruby-operator">&gt;</span><span class="ruby-string">&#39;s options
    if (self.isSelect &amp;&amp; !$(&#39;</span><span class="ruby-identifier">option</span>[<span class="ruby-identifier">value</span>=<span class="ruby-string">&quot;&#39; + escape(itemValue) + &#39;&quot;</span>]<span class="ruby-string">&#39;,self.$element)[0]) {
      var $option = $(&#39;</span><span class="ruby-operator">&lt;</span><span class="ruby-identifier">option</span> <span class="ruby-identifier">selected</span><span class="ruby-operator">&gt;</span><span class="ruby-string">&#39; + htmlEncode(itemText) + &#39;</span><span class="ruby-operator">&lt;</span><span class="ruby-regexp">/option&gt;&#39;);
      $option.data(&#39;item&#39;, item);
      $option.attr(&#39;value&#39;, itemValue);
      self.$element.append($option);
    }

    if (!dontPushVal)
      self.pushVal();

    /</span><span class="ruby-operator">/</span> <span class="ruby-constant">Add</span> <span class="ruby-keyword">class</span> <span class="ruby-keyword">when</span> <span class="ruby-identifier">reached</span> <span class="ruby-identifier">maxTags</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-keyword">self</span>.<span class="ruby-identifier">options</span>.<span class="ruby-identifier">maxTags</span> <span class="ruby-operator">===</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">itemsArray</span>.<span class="ruby-identifier">length</span>)
      <span class="ruby-keyword">self</span>.<span class="ruby-identifier">$container</span>.<span class="ruby-identifier">addClass</span>(<span class="ruby-string">&#39;bootstrap-tagsinput-max&#39;</span>);

    <span class="ruby-keyword">self</span>.<span class="ruby-identifier">$element</span>.<span class="ruby-identifier">trigger</span>(<span class="ruby-identifier">$.</span><span class="ruby-constant">Event</span>(<span class="ruby-string">&#39;itemAdded&#39;</span>, { <span class="ruby-identifier">item</span><span class="ruby-operator">:</span> <span class="ruby-identifier">item</span> }));
  },

  <span class="ruby-regexp">/**
     Removes the given item. Pass true to dontPushVal to prevent updating the
     elements val()
    /</span>
  <span class="ruby-identifier">remove</span><span class="ruby-operator">:</span> <span class="ruby-identifier">function</span>(<span class="ruby-identifier">item</span>, <span class="ruby-identifier">dontPushVal</span>) {
    <span class="ruby-identifier">var</span> <span class="ruby-keyword">self</span> = <span class="ruby-identifier">this</span>;

    <span class="ruby-keyword">if</span> (<span class="ruby-keyword">self</span>.<span class="ruby-identifier">objectItems</span>) {
      <span class="ruby-keyword">if</span> (<span class="ruby-identifier">typeof</span> <span class="ruby-identifier">item</span> <span class="ruby-operator">===</span> <span class="ruby-string">&quot;object&quot;</span>)
        <span class="ruby-identifier">item</span> = <span class="ruby-identifier">$.</span><span class="ruby-identifier">grep</span>(<span class="ruby-keyword">self</span>.<span class="ruby-identifier">itemsArray</span>, <span class="ruby-identifier">function</span>(<span class="ruby-identifier">other</span>) { <span class="ruby-keyword">return</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">options</span>.<span class="ruby-identifier">itemValue</span>(<span class="ruby-identifier">other</span>) <span class="ruby-operator">==</span>  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">options</span>.<span class="ruby-identifier">itemValue</span>(<span class="ruby-identifier">item</span>); } )[<span class="ruby-value">0</span>];
      <span class="ruby-keyword">else</span>
        <span class="ruby-identifier">item</span> = <span class="ruby-identifier">$.</span><span class="ruby-identifier">grep</span>(<span class="ruby-keyword">self</span>.<span class="ruby-identifier">itemsArray</span>, <span class="ruby-identifier">function</span>(<span class="ruby-identifier">other</span>) { <span class="ruby-keyword">return</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">options</span>.<span class="ruby-identifier">itemValue</span>(<span class="ruby-identifier">other</span>) <span class="ruby-operator">==</span>  <span class="ruby-identifier">item</span>; } )[<span class="ruby-value">0</span>];
    }

    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">item</span>) {
      $(<span class="ruby-string">&#39;.tag&#39;</span>, <span class="ruby-keyword">self</span>.<span class="ruby-identifier">$container</span>).<span class="ruby-identifier">filter</span>(<span class="ruby-identifier">function</span>() { <span class="ruby-keyword">return</span> $(<span class="ruby-identifier">this</span>).<span class="ruby-identifier">data</span>(<span class="ruby-string">&#39;item&#39;</span>) <span class="ruby-operator">===</span> <span class="ruby-identifier">item</span>; }).<span class="ruby-identifier">remove</span>();
      $(<span class="ruby-string">&#39;option&#39;</span>, <span class="ruby-keyword">self</span>.<span class="ruby-identifier">$element</span>).<span class="ruby-identifier">filter</span>(<span class="ruby-identifier">function</span>() { <span class="ruby-keyword">return</span> $(<span class="ruby-identifier">this</span>).<span class="ruby-identifier">data</span>(<span class="ruby-string">&#39;item&#39;</span>) <span class="ruby-operator">===</span> <span class="ruby-identifier">item</span>; }).<span class="ruby-identifier">remove</span>();
      <span class="ruby-keyword">self</span>.<span class="ruby-identifier">itemsArray</span>.<span class="ruby-identifier">splice</span>(<span class="ruby-identifier">$.</span><span class="ruby-identifier">inArray</span>(<span class="ruby-identifier">item</span>, <span class="ruby-keyword">self</span>.<span class="ruby-identifier">itemsArray</span>), <span class="ruby-value">1</span>);
    }

    <span class="ruby-keyword">if</span> (<span class="ruby-operator">!</span><span class="ruby-identifier">dontPushVal</span>)
      <span class="ruby-keyword">self</span>.<span class="ruby-identifier">pushVal</span>();

    <span class="ruby-regexp">//</span> <span class="ruby-constant">Remove</span> <span class="ruby-keyword">class</span> <span class="ruby-keyword">when</span> <span class="ruby-identifier">reached</span> <span class="ruby-identifier">maxTags</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-keyword">self</span>.<span class="ruby-identifier">options</span>.<span class="ruby-identifier">maxTags</span> <span class="ruby-operator">&gt;</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">itemsArray</span>.<span class="ruby-identifier">length</span>)
      <span class="ruby-keyword">self</span>.<span class="ruby-identifier">$container</span>.<span class="ruby-identifier">removeClass</span>(<span class="ruby-string">&#39;bootstrap-tagsinput-max&#39;</span>);

    <span class="ruby-keyword">self</span>.<span class="ruby-identifier">$element</span>.<span class="ruby-identifier">trigger</span>(<span class="ruby-identifier">$.</span><span class="ruby-constant">Event</span>(<span class="ruby-string">&#39;itemRemoved&#39;</span>,  { <span class="ruby-identifier">item</span><span class="ruby-operator">:</span> <span class="ruby-identifier">item</span> }));
  },

  <span class="ruby-regexp">/**
     Removes all items
    /</span>
  <span class="ruby-identifier">removeAll</span><span class="ruby-operator">:</span> <span class="ruby-identifier">function</span>() {
    <span class="ruby-identifier">var</span> <span class="ruby-keyword">self</span> = <span class="ruby-identifier">this</span>;

    $(<span class="ruby-string">&#39;.tag&#39;</span>, <span class="ruby-keyword">self</span>.<span class="ruby-identifier">$container</span>).<span class="ruby-identifier">remove</span>();
    $(<span class="ruby-string">&#39;option&#39;</span>, <span class="ruby-keyword">self</span>.<span class="ruby-identifier">$element</span>).<span class="ruby-identifier">remove</span>();

    <span class="ruby-keyword">while</span>(<span class="ruby-keyword">self</span>.<span class="ruby-identifier">itemsArray</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>)
      <span class="ruby-keyword">self</span>.<span class="ruby-identifier">itemsArray</span>.<span class="ruby-identifier">pop</span>();

    <span class="ruby-keyword">self</span>.<span class="ruby-identifier">pushVal</span>();

    <span class="ruby-keyword">if</span> (<span class="ruby-keyword">self</span>.<span class="ruby-identifier">options</span>.<span class="ruby-identifier">maxTags</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">this</span>.<span class="ruby-identifier">isEnabled</span>())
      <span class="ruby-identifier">this</span>.<span class="ruby-identifier">enable</span>();
  },

  <span class="ruby-regexp">/**
     Refreshes the tags so they match the text/</span><span class="ruby-identifier">value</span> <span class="ruby-identifier">of</span> <span class="ruby-identifier">their</span> <span class="ruby-identifier">corresponding</span>
     <span class="ruby-identifier">item</span>.
    <span class="ruby-operator">/</span>
  <span class="ruby-identifier">refresh</span><span class="ruby-operator">:</span> <span class="ruby-identifier">function</span>() {
    <span class="ruby-identifier">var</span> <span class="ruby-keyword">self</span> = <span class="ruby-identifier">this</span>;
    $(<span class="ruby-string">&#39;.tag&#39;</span>, <span class="ruby-keyword">self</span>.<span class="ruby-identifier">$container</span>).<span class="ruby-identifier">each</span>(<span class="ruby-identifier">function</span>() {
      <span class="ruby-identifier">var</span> <span class="ruby-identifier">$tag</span> = $(<span class="ruby-identifier">this</span>),
          <span class="ruby-identifier">item</span> = <span class="ruby-identifier">$tag</span>.<span class="ruby-identifier">data</span>(<span class="ruby-string">&#39;item&#39;</span>),
          <span class="ruby-identifier">itemValue</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">options</span>.<span class="ruby-identifier">itemValue</span>(<span class="ruby-identifier">item</span>),
          <span class="ruby-identifier">itemText</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">options</span>.<span class="ruby-identifier">itemText</span>(<span class="ruby-identifier">item</span>),
          <span class="ruby-identifier">tagClass</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">options</span>.<span class="ruby-identifier">tagClass</span>(<span class="ruby-identifier">item</span>);

        <span class="ruby-regexp">//</span> <span class="ruby-constant">Update</span> <span class="ruby-identifier">tag</span><span class="ruby-string">&#39;s class and inner text
        $tag.attr(&#39;</span><span class="ruby-identifier">class</span><span class="ruby-string">&#39;, null);
        $tag.addClass(&#39;</span><span class="ruby-identifier">tag</span> <span class="ruby-string">&#39; + htmlEncode(tagClass));
        $tag.contents().filter(function() {
          return this.nodeType == 3;
        })[0].nodeValue = htmlEncode(itemText);

        if (self.isSelect) {
          var option = $(&#39;</span><span class="ruby-identifier">option</span><span class="ruby-string">&#39;, self.$element).filter(function() { return $(this).data(&#39;</span><span class="ruby-identifier">item</span><span class="ruby-string">&#39;) === item; });
          option.attr(&#39;</span><span class="ruby-identifier">value</span><span class="ruby-string">&#39;, itemValue);
        }
    });
  },

  /**
     Returns the items added as tags
    /
  items: function() {
    return this.itemsArray;
  },

  /**
     Assembly value by retrieving the value of each item, and set it on the
     element. 
    /
  pushVal: function() {
    var self = this,
        val = $.map(self.items(), function(item) {
          return self.options.itemValue(item).toString();
        });

    self.$element.val(val, true).trigger(&#39;</span><span class="ruby-identifier">change</span><span class="ruby-string">&#39;);
  },

  /**
     Initializes the tags input behaviour on the element
    /
  build: function(options) {
    var self = this;

    self.options = $.extend({}, defaultOptions, options);
    var typeahead = self.options.typeahead || {};

    // When itemValue is set, freeInput should always be false
    if (self.objectItems)
      self.options.freeInput = false;

    makeOptionItemFunction(self.options, &#39;</span><span class="ruby-identifier">itemValue</span><span class="ruby-string">&#39;);
    makeOptionItemFunction(self.options, &#39;</span><span class="ruby-identifier">itemText</span><span class="ruby-string">&#39;);
    makeOptionItemFunction(self.options, &#39;</span><span class="ruby-identifier">tagClass</span><span class="ruby-string">&#39;);

    // for backwards compatibility, self.options.source is deprecated
    if (self.options.source)
      typeahead.source = self.options.source;

    if (typeahead.source &amp;&amp; $.fn.typeahead) {
      makeOptionFunction(typeahead, &#39;</span><span class="ruby-identifier">source</span><span class="ruby-string">&#39;);

      self.$input.typeahead({
        source: function (query, process) {
          function processItems(items) {
            var texts = [];

            for (var i = 0; i &lt; items.length; i++) {
              var text = self.options.itemText(items[i]);
              map[text] = items[i];
              texts.push(text);
            }
            process(texts);
          }

          this.map = {};
          var map = this.map,
              data = typeahead.source(query);

          if ($.isFunction(data.success)) {
            // support for Angular promises
            data.success(processItems);
          } else {
            // support for functions and jquery promises
            $.when(data)
             .then(processItems);
          }
        },
        updater: function (text) {
          self.add(this.map[text]);
        },
        matcher: function (text) {
          return (text.toLowerCase().indexOf(this.query.trim().toLowerCase()) !== -1);
        },
        sorter: function (texts) {
          return texts.sort();
        },
        highlighter: function (text) {
          var regex = new RegExp( &#39;</span>(<span class="ruby-string">&#39; + this.query + &#39;</span>)<span class="ruby-string">&#39;, &#39;</span><span class="ruby-identifier">gi</span><span class="ruby-string">&#39; );
          return text.replace( regex, &quot;&lt;strong&gt;$1&lt;/strong&gt;&quot; );
        }
      });
    }

    self.$container.on(&#39;</span><span class="ruby-identifier">click</span><span class="ruby-string">&#39;, $.proxy(function(event) {
      self.$input.focus();
    }, self));

    self.$container.on(&#39;</span><span class="ruby-identifier">keydown</span><span class="ruby-string">&#39;, &#39;</span><span class="ruby-identifier">input</span><span class="ruby-string">&#39;, $.proxy(function(event) {
      var $input = $(event.target),
          $inputWrapper = self.findInputWrapper();

      switch (event.which) {
        // BACKSPACE
        case 8:
          if (doGetCaretPosition($input[0]) === 0) {
            var prev = $inputWrapper.prev();
            if (prev) {
              self.remove(prev.data(&#39;</span><span class="ruby-identifier">item</span><span class="ruby-string">&#39;));
            }
          }
          break;

        // DELETE
        case 46:
          if (doGetCaretPosition($input[0]) === 0) {
            var next = $inputWrapper.next();
            if (next) {
              self.remove(next.data(&#39;</span><span class="ruby-identifier">item</span><span class="ruby-string">&#39;));
            }
          }
          break;

        // LEFT ARROW
        case 37:
          // Try to move the input before the previous tag
          var $prevTag = $inputWrapper.prev();
          if ($input.val().length === 0 &amp;&amp; $prevTag[0]) {
            $prevTag.before($inputWrapper);
            $input.focus();
          }
          break;
        // RIGHT ARROW
        case 39:
          // Try to move the input after the next tag
          var $nextTag = $inputWrapper.next();
          if ($input.val().length === 0 &amp;&amp; $nextTag[0]) {
            $nextTag.after($inputWrapper);
            $input.focus();
          }
          break;
       default:
          // When key corresponds one of the confirmKeys, add current input
          // as a new tag
          if (self.options.freeInput &amp;&amp; $.inArray(event.which, self.options.confirmKeys) &gt;= 0) {
            self.add($input.val());
            $input.val(&#39;</span><span class="ruby-string">&#39;);
            event.preventDefault();
          }
      }

      // Reset internal input&#39;</span><span class="ruby-identifier">s</span> <span class="ruby-identifier">size</span>
      <span class="ruby-identifier">$input</span>.<span class="ruby-identifier">attr</span>(<span class="ruby-string">&#39;size&#39;</span>, <span class="ruby-constant">Math</span>.<span class="ruby-identifier">max</span>(<span class="ruby-identifier">this</span>.<span class="ruby-identifier">inputSize</span>, <span class="ruby-identifier">$input</span>.<span class="ruby-identifier">val</span>().<span class="ruby-identifier">length</span>));
    }, <span class="ruby-keyword">self</span>));

    <span class="ruby-regexp">//</span> <span class="ruby-constant">Remove</span> <span class="ruby-identifier">icon</span> <span class="ruby-identifier">clicked</span>
    <span class="ruby-keyword">self</span>.<span class="ruby-identifier">$container</span>.<span class="ruby-identifier">on</span>(<span class="ruby-string">&#39;click&#39;</span>, <span class="ruby-string">&#39;[data-role=remove]&#39;</span>, <span class="ruby-identifier">$.</span><span class="ruby-identifier">proxy</span>(<span class="ruby-identifier">function</span>(<span class="ruby-identifier">event</span>) {
      <span class="ruby-keyword">self</span>.<span class="ruby-identifier">remove</span>($(<span class="ruby-identifier">event</span>.<span class="ruby-identifier">target</span>).<span class="ruby-identifier">closest</span>(<span class="ruby-string">&#39;.tag&#39;</span>).<span class="ruby-identifier">data</span>(<span class="ruby-string">&#39;item&#39;</span>));
    }, <span class="ruby-keyword">self</span>));

    <span class="ruby-regexp">//</span> <span class="ruby-constant">Only</span> <span class="ruby-identifier">add</span> <span class="ruby-identifier">existing</span> <span class="ruby-identifier">value</span> <span class="ruby-identifier">as</span> <span class="ruby-identifier">tags</span> <span class="ruby-keyword">when</span> <span class="ruby-identifier">using</span> <span class="ruby-identifier">strings</span> <span class="ruby-identifier">as</span> <span class="ruby-identifier">tags</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-keyword">self</span>.<span class="ruby-identifier">options</span>.<span class="ruby-identifier">itemValue</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">defaultOptions</span>.<span class="ruby-identifier">itemValue</span>) {
      <span class="ruby-keyword">if</span> (<span class="ruby-keyword">self</span>.<span class="ruby-identifier">$element</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">tagName</span> <span class="ruby-operator">===</span> <span class="ruby-string">&#39;INPUT&#39;</span>) {
          <span class="ruby-keyword">self</span>.<span class="ruby-identifier">add</span>(<span class="ruby-keyword">self</span>.<span class="ruby-identifier">$element</span>.<span class="ruby-identifier">val</span>());
      } <span class="ruby-keyword">else</span> {
        $(<span class="ruby-string">&#39;option&#39;</span>, <span class="ruby-keyword">self</span>.<span class="ruby-identifier">$element</span>).<span class="ruby-identifier">each</span>(<span class="ruby-identifier">function</span>() {
          <span class="ruby-keyword">self</span>.<span class="ruby-identifier">add</span>($(<span class="ruby-identifier">this</span>).<span class="ruby-identifier">attr</span>(<span class="ruby-string">&#39;value&#39;</span>), <span class="ruby-keyword">true</span>);
        });
      }
    }
  },

  <span class="ruby-regexp">/**
     Removes all tagsinput behaviour and unregsiter all event handlers
    /</span>
  <span class="ruby-identifier">destroy</span><span class="ruby-operator">:</span> <span class="ruby-identifier">function</span>() {
    <span class="ruby-identifier">var</span> <span class="ruby-keyword">self</span> = <span class="ruby-identifier">this</span>;

    <span class="ruby-regexp">//</span> <span class="ruby-constant">Unbind</span> <span class="ruby-identifier">events</span>
    <span class="ruby-keyword">self</span>.<span class="ruby-identifier">$container</span>.<span class="ruby-identifier">off</span>(<span class="ruby-string">&#39;keypress&#39;</span>, <span class="ruby-string">&#39;input&#39;</span>);
    <span class="ruby-keyword">self</span>.<span class="ruby-identifier">$container</span>.<span class="ruby-identifier">off</span>(<span class="ruby-string">&#39;click&#39;</span>, <span class="ruby-string">&#39;[role=remove]&#39;</span>);

    <span class="ruby-keyword">self</span>.<span class="ruby-identifier">$container</span>.<span class="ruby-identifier">remove</span>();
    <span class="ruby-keyword">self</span>.<span class="ruby-identifier">$element</span>.<span class="ruby-identifier">removeData</span>(<span class="ruby-string">&#39;tagsinput&#39;</span>);
    <span class="ruby-keyword">self</span>.<span class="ruby-identifier">$element</span>.<span class="ruby-identifier">show</span>();
  },

  <span class="ruby-regexp">/**
     Sets focus on the tagsinput 
    /</span>
  <span class="ruby-identifier">focus</span><span class="ruby-operator">:</span> <span class="ruby-identifier">function</span>() {
    <span class="ruby-identifier">this</span>.<span class="ruby-identifier">$input</span>.<span class="ruby-identifier">focus</span>();
  },

  <span class="ruby-regexp">/**
     Returns the internal input element
    /</span>
  <span class="ruby-identifier">input</span><span class="ruby-operator">:</span> <span class="ruby-identifier">function</span>() {
    <span class="ruby-keyword">return</span> <span class="ruby-identifier">this</span>.<span class="ruby-identifier">$input</span>;
  },

  <span class="ruby-regexp">/**
     Returns the element which is wrapped around the internal input. This
     is normally the $container, but typeahead.js moves the $input element.
    /</span>
  <span class="ruby-identifier">findInputWrapper</span><span class="ruby-operator">:</span> <span class="ruby-identifier">function</span>() {
    <span class="ruby-identifier">var</span> <span class="ruby-identifier">elt</span> = <span class="ruby-identifier">this</span>.<span class="ruby-identifier">$input</span>[<span class="ruby-value">0</span>],
        <span class="ruby-identifier">container</span> = <span class="ruby-identifier">this</span>.<span class="ruby-identifier">$container</span>[<span class="ruby-value">0</span>];
    <span class="ruby-keyword">while</span>(<span class="ruby-identifier">elt</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">elt</span>.<span class="ruby-identifier">parentNode</span> <span class="ruby-operator">!=</span>= <span class="ruby-identifier">container</span>)
      <span class="ruby-identifier">elt</span> = <span class="ruby-identifier">elt</span>.<span class="ruby-identifier">parentNode</span>;

    <span class="ruby-keyword">return</span> $(<span class="ruby-identifier">elt</span>);
  }
};

<span class="ruby-regexp">/**
   Register JQuery plugin
  /</span>
<span class="ruby-identifier">$.</span><span class="ruby-identifier">fn</span>.<span class="ruby-identifier">tagsinput</span> = <span class="ruby-identifier">function</span>(<span class="ruby-identifier">arg1</span>, <span class="ruby-identifier">arg2</span>) {
  <span class="ruby-identifier">var</span> <span class="ruby-identifier">results</span> = [];

  <span class="ruby-identifier">this</span>.<span class="ruby-identifier">each</span>(<span class="ruby-identifier">function</span>() {
    <span class="ruby-identifier">var</span> <span class="ruby-identifier">tagsinput</span> = $(<span class="ruby-identifier">this</span>).<span class="ruby-identifier">data</span>(<span class="ruby-string">&#39;tagsinput&#39;</span>);

    <span class="ruby-regexp">//</span> <span class="ruby-constant">Initialize</span> <span class="ruby-identifier">a</span> <span class="ruby-identifier">new</span> <span class="ruby-identifier">tags</span> <span class="ruby-identifier">input</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-operator">!</span><span class="ruby-identifier">tagsinput</span>) {
      <span class="ruby-identifier">tagsinput</span> = <span class="ruby-identifier">new</span> <span class="ruby-constant">TagsInput</span>(<span class="ruby-identifier">this</span>, <span class="ruby-identifier">arg1</span>);
      $(<span class="ruby-identifier">this</span>).<span class="ruby-identifier">data</span>(<span class="ruby-string">&#39;tagsinput&#39;</span>, <span class="ruby-identifier">tagsinput</span>);
      <span class="ruby-identifier">results</span>.<span class="ruby-identifier">push</span>(<span class="ruby-identifier">tagsinput</span>);

      <span class="ruby-keyword">if</span> (<span class="ruby-identifier">this</span>.<span class="ruby-identifier">tagName</span> <span class="ruby-operator">===</span> <span class="ruby-string">&#39;SELECT&#39;</span>) {
        $(<span class="ruby-string">&#39;option&#39;</span>, $(<span class="ruby-identifier">this</span>)).<span class="ruby-identifier">attr</span>(<span class="ruby-string">&#39;selected&#39;</span>, <span class="ruby-string">&#39;selected&#39;</span>);
      }

      <span class="ruby-regexp">//</span> <span class="ruby-constant">Init</span> <span class="ruby-identifier">tags</span> <span class="ruby-identifier">from</span> $(<span class="ruby-identifier">this</span>).<span class="ruby-identifier">val</span>()
      $(<span class="ruby-identifier">this</span>).<span class="ruby-identifier">val</span>($(<span class="ruby-identifier">this</span>).<span class="ruby-identifier">val</span>());
    } <span class="ruby-keyword">else</span> {
      <span class="ruby-regexp">//</span> <span class="ruby-constant">Invoke</span> <span class="ruby-identifier">function</span> <span class="ruby-identifier">on</span> <span class="ruby-identifier">existing</span> <span class="ruby-identifier">tags</span> <span class="ruby-identifier">input</span>
      <span class="ruby-identifier">var</span> <span class="ruby-identifier">retVal</span> = <span class="ruby-identifier">tagsinput</span>[<span class="ruby-identifier">arg1</span>](<span class="ruby-identifier">arg2</span>);
      <span class="ruby-keyword">if</span> (<span class="ruby-identifier">retVal</span> <span class="ruby-operator">!=</span>= <span class="ruby-identifier">undefined</span>)
        <span class="ruby-identifier">results</span>.<span class="ruby-identifier">push</span>(<span class="ruby-identifier">retVal</span>);
    }
  });

  <span class="ruby-keyword">if</span> ( <span class="ruby-identifier">typeof</span> <span class="ruby-identifier">arg1</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;string&#39;</span>) {
    <span class="ruby-regexp">//</span> <span class="ruby-constant">Return</span> <span class="ruby-identifier">the</span> <span class="ruby-identifier">results</span> <span class="ruby-identifier">from</span> <span class="ruby-identifier">the</span> <span class="ruby-identifier">invoked</span> <span class="ruby-identifier">function</span> <span class="ruby-identifier">calls</span>
    <span class="ruby-keyword">return</span> <span class="ruby-identifier">results</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">results</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">results</span>[<span class="ruby-value">0</span>];
  } <span class="ruby-keyword">else</span> {
    <span class="ruby-keyword">return</span> <span class="ruby-identifier">results</span>;
  }
};

<span class="ruby-identifier">$.</span><span class="ruby-identifier">fn</span>.<span class="ruby-identifier">tagsinput</span>.<span class="ruby-constant">Constructor</span> = <span class="ruby-constant">TagsInput</span>;

<span class="ruby-regexp">/**
   Most options support both a string or number as well as a function as 
   option value. This function makes sure that the option with the given
   key in the given options is wrapped in a function
  /</span>
<span class="ruby-identifier">function</span> <span class="ruby-identifier">makeOptionItemFunction</span>(<span class="ruby-identifier">options</span>, <span class="ruby-identifier">key</span>) {
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">typeof</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">key</span>] <span class="ruby-operator">!=</span>= <span class="ruby-string">&#39;function&#39;</span>) {
    <span class="ruby-identifier">var</span> <span class="ruby-identifier">propertyName</span> = <span class="ruby-identifier">options</span>[<span class="ruby-identifier">key</span>];
    <span class="ruby-identifier">options</span>[<span class="ruby-identifier">key</span>] = <span class="ruby-identifier">function</span>(<span class="ruby-identifier">item</span>) { <span class="ruby-keyword">return</span> <span class="ruby-identifier">item</span>[<span class="ruby-identifier">propertyName</span>]; };
  }
}
<span class="ruby-identifier">function</span> <span class="ruby-identifier">makeOptionFunction</span>(<span class="ruby-identifier">options</span>, <span class="ruby-identifier">key</span>) {
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">typeof</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">key</span>] <span class="ruby-operator">!=</span>= <span class="ruby-string">&#39;function&#39;</span>) {
    <span class="ruby-identifier">var</span> <span class="ruby-identifier">value</span> = <span class="ruby-identifier">options</span>[<span class="ruby-identifier">key</span>];
    <span class="ruby-identifier">options</span>[<span class="ruby-identifier">key</span>] = <span class="ruby-identifier">function</span>() { <span class="ruby-keyword">return</span> <span class="ruby-identifier">value</span>; };
  }
}
<span class="ruby-regexp">/**
   HtmlEncodes the given value
  /</span>
<span class="ruby-identifier">var</span> <span class="ruby-identifier">htmlEncodeContainer</span> = $(<span class="ruby-string">&#39;&lt;div /&gt;&#39;</span>);
<span class="ruby-identifier">function</span> <span class="ruby-identifier">htmlEncode</span>(<span class="ruby-identifier">value</span>) {
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">value</span>) {
    <span class="ruby-keyword">return</span> <span class="ruby-identifier">htmlEncodeContainer</span>.<span class="ruby-identifier">text</span>(<span class="ruby-identifier">value</span>).<span class="ruby-identifier">html</span>();
  } <span class="ruby-keyword">else</span> {
    <span class="ruby-keyword">return</span> <span class="ruby-string">&#39;&#39;</span>;
  }
}

<span class="ruby-regexp">/**
   Returns the position of the caret in the given input field
   http:/</span><span class="ruby-operator">/</span><span class="ruby-identifier">flightschool</span>.<span class="ruby-identifier">acylt</span>.<span class="ruby-identifier">com</span><span class="ruby-operator">/</span><span class="ruby-identifier">devnotes</span><span class="ruby-operator">/</span><span class="ruby-identifier">caret</span><span class="ruby-operator">-</span><span class="ruby-identifier">position</span><span class="ruby-operator">-</span><span class="ruby-identifier">woes</span><span class="ruby-operator">/</span>
  <span class="ruby-regexp">/
function doGetCaretPosition(oField) {
  var iCaretPos = 0;
  if (document.selection) {
    oField.focus ();
    var oSel = document.selection.createRange();
    oSel.moveStart (&#39;character&#39;, -oField.value.length);
    iCaretPos = oSel.text.length;
  } else if (oField.selectionStart || oField.selectionStart == &#39;0&#39;) {
    iCaretPos = oField.selectionStart;
  }
  return (iCaretPos);
}

/</span><span class="ruby-operator">**</span>
   <span class="ruby-constant">Initialize</span> <span class="ruby-identifier">tagsinput</span> <span class="ruby-identifier">behaviour</span> <span class="ruby-identifier">on</span> <span class="ruby-identifier">inputs</span> <span class="ruby-keyword">and</span> <span class="ruby-identifier">selects</span> <span class="ruby-identifier">which</span> <span class="ruby-identifier">have</span>
   <span class="ruby-identifier">data</span><span class="ruby-operator">-</span><span class="ruby-identifier">role</span>=<span class="ruby-identifier">tagsinput</span>
  <span class="ruby-regexp">/
$(function() {
  $(&quot;input[data-role=tagsinput], select[multiple][data-role=tagsinput]&quot;).tagsinput();
});
</span></pre>

<p>})(window.jQuery);</p>
</main>



<footer id="validator-badges" role="contentinfo">
  <p><a href="http://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="http://rdoc.rubyforge.org">RDoc</a> 4.1.1.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

