!function(){var e,t=function(e,t){return function(){return e.apply(t,arguments)}},o={}.hasOwnProperty,s=function(e,t){function s(){this.constructor=e}for(var l in t)o.call(t,l)&&(e[l]=t[l]);return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e};if("undefined"==typeof Backbone||null===Backbone)throw new Error("Backbone is not defined. Please include the latest version from http://documentcloud.github.com/backbone/backbone.js");Backbone.Marionette.Modals=function(o){function l(){return this.close=t(this.close,this),e=l.__super__.constructor.apply(this,arguments)}return s(l,o),l.prototype.modals=[],l.prototype.zIndex=0,l.prototype.show=function(e,t){var o,s,l,n,r,a;for(null==t&&(t={}),this.ensureEl(),this.modals.length>0&&(o=_.last(this.modals),o.modalEl.addClass(""+o.prefix+"-modal--stacked"),l=this.modals[this.modals.length-1],null!=l&&l.modalEl.removeClass(""+l.prefix+"-modal--stacked-reverse")),e.render(),e.regionEnabled=!0,this.$el.show(),this.$el.append(e.el),this.modals.length>0&&e.$el.css({background:"none"}),Marionette.triggerMethod.call(e,"show"),Marionette.triggerMethod.call(this,"show",e),this.currentView=e,a=this.modals,n=0,r=a.length;r>n;n++)s=a[n],s.undelegateModalEvents();return e.on("modal:close",this.close),this.modals.push(e),this.zIndex++},l.prototype.close=function(){var e,t;return t=this.currentView,t&&!t.isClosed?(t.close?t.close():t.remove&&t.remove(),t.off("modal:close",this.close),this.modals.splice(_.indexOf(this.modals,t),1),this.zIndex--,this.currentView=this.modals[this.zIndex-1],e=_.last(this.modals),e&&(e.modalEl.addClass(""+e.prefix+"-modal--stacked-reverse"),_.delay(function(){return e.modalEl.removeClass(""+e.prefix+"-modal--stacked")},300),0!==this.zIndex&&e.delegateModalEvents()),Marionette.triggerMethod.call(this,"close")):void 0},l.prototype.closeAll=function(){var e,t,o,s,l;for(s=this.modals,l=[],t=0,o=s.length;o>t;t++)e=s[t],l.push(this.close());return l},l}(Backbone.Marionette.Region)}.call(this);